"use strict";angular.module("journyApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.bootstrap"]).config(["$routeProvider","$locationProvider",function(a){a.when("/home",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).otherwise({redirectTo:"/home"})}]),angular.module("journyApp").controller("MainCtrl",["$scope",function(){}]),angular.module("journyApp").controller("AboutCtrl",["$scope",function(){}]),angular.module("journyApp").controller("RootCtrl",["$scope","$modal","$log","$cookies",function(a,b,c,d){a.currentUser=d.jour_user}]),angular.module("journyApp").constant("URLS",{BASE_URL:"http://ec2-54-187-188-166.us-west-2.compute.amazonaws.com/",LOGIN_URL:"accounts/session/"}),angular.module("journyApp").constant("AUTH_EVENTS",{loginSuccess:"auth-login-success",loginFailed:"auth-login-failed",logoutSuccess:"auth-logout-success",sessionTimeout:"auth-session-timeout",notAuthenticated:"auth-not-authenticated",notAuthorized:"auth-not-authorized"}),angular.module("journyApp").service("sessionService",["$cookies",function(a){return this.create=function(b,c){this.jour_session_key=b,this.jour_user=c,a.jour_session_key=b,a.jour_user=c},this.destroy=function(){this.jour_user=null,this.jour_session_key=null},this}]),angular.module("journyApp").factory("AuthService",["$http","URLS","sessionService","$q",function(a,b,c,d){var e={};return e.login=function(e){var f=null,g=null,h=d.defer(),i=h.promise,j=new FormData;j.append("username",e.username),j.append("password",e.password);a({url:b.BASE_URL+b.LOGIN_URL,data:j,transformRequest:angular.identity,method:"POST",headers:{"Content-Type":void 0}}).then(function(a){var b=a.data;0==b.status&&(b=b.data,c.create(b.jour_session_key,b.username),f={username:b.username},h.resolve(f)),2==b.status&&(g=b.data,h.reject(g))},function(){console.log("WTF")});return i},e.isAuthenticated=function(){return void 0==c.getSessionKey()||null==c.getSessionKey()?!0:!1},e}]),angular.module("journyApp").controller("HeaderCtrl",["$scope","AuthService","$modal","$log",function(a,b,c,d){a.showLoginForm=function(){var b=c.open({templateUrl:"partials/loginModal.html",controller:"LoginCtrl",size:"lg"});b.result.then(function(b){a.selected=b},function(){d.info("Modal dismissed at: "+new Date)})}}]),angular.module("journyApp").controller("LoginCtrl",["$scope","AuthService",function(a,b){a.credentials={username:"",password:""},a.login=function(a){b.login(a).then(function(a){console.log(a.username)},function(a){console.log(a)})}}]);